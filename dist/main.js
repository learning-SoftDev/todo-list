(()=>{const e=document.querySelector("#addProject"),t=document.querySelector("#projectForm"),a=document.querySelector("#projectInput");e.addEventListener("click",(()=>{t.classList.remove("hidden"),a.focus()}));const s=document.querySelector("#addList"),d=document.querySelector("#taskForm"),l=document.querySelector(".listSubmitBtn"),r=document.querySelector("#editConfirm");s.addEventListener("click",(()=>{d.classList.remove("hidden"),l.classList.remove("hidden"),r.classList.add("hidden")})),document.querySelector("#checkbox").addEventListener("change",(()=>document.body.classList.toggle("light"))),document.querySelector(".hiddenMenu").addEventListener("click",(()=>{document.querySelector(".leftPanel").classList.toggle("hidden")}));const c=()=>{const e=document.querySelector("#projectForm"),t=document.querySelector("#projectInput"),a=document.querySelector(".projectValidation");t.value="",e.classList.add("hidden"),a.classList.add("hidden")},o=()=>{const e=document.querySelector("#taskForm"),t=document.querySelector("#listInput"),a=document.querySelector("#listInputDetail"),i=document.querySelector("#listInputDate"),s=document.querySelector(".taskValidation");t.value="",a.value="",i.value="",e.classList.add("hidden"),s.classList.add("hidden"),document.querySelector(".list-todo").appendChild(e),k()};function n(e){this.projectName=e,this.lastSelected=!0}document.querySelector(".projectCancelBtn").addEventListener("click",c),document.querySelector(".listCancelBtn").addEventListener("click",o),window.addEventListener("load",(()=>{projectList=JSON.parse(localStorage.getItem("projectList"))||[],document.querySelector("#projectForm").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("projectInput").value,a=document.querySelector(".projectValidation");if(projectList.filter((e=>e.projectName===t)).length>0)return void a.classList.remove("hidden");const i=new n(t);projectList.push(i),u(),e.target.reset(),c(),p(),document.querySelector("#projectCompleteList").lastChild.querySelector(".tile").click()})),isHomeTile=!0,p()}));const u=()=>{localStorage.setItem("projectList",JSON.stringify(projectList)),localStorage.setItem("taskList",JSON.stringify(taskList))},m=e=>{const t=document.createElement("span");return t.classList.add("material-icons-round"),t.textContent=e,t},p=()=>{document.querySelector("#projectCompleteList").innerHTML="",projectList.forEach((e=>{const t=document.querySelector("#projectCompleteList"),a=document.createElement("div"),i=document.createElement("div"),s=m("menu"),d=document.createElement("input");d.setAttribute("readonly",""),d.setAttribute("spellcheck",!1),d.setAttribute("maxlength",12);const l=m("edit"),r=m("delete");i.classList.add("tile"),e.lastSelected&&i.classList.add("lastSelected"),d.classList.add("projectName"),r.classList.add("projDelIcon"),d.value=e.projectName,i.appendChild(s),i.appendChild(d),i.appendChild(l),i.appendChild(r),a.appendChild(i),t.appendChild(a),r.addEventListener("click",(()=>{projectList=projectList.filter((t=>t.projectName!==e.projectName)),taskList=taskList.filter((t=>t.projectName!==e.projectName)),u(),p(),document.getElementById("allTasks").click()})),l.addEventListener("click",(()=>{projectNameEdit=i.querySelector(".projectName"),projectNameEdit.classList.toggle("projectNameEdit"),originalProjName=projectNameEdit.value,projectNameEdit.removeAttribute("readonly"),projectNameEdit.focus(),projectNameEdit.addEventListener("keypress",c,!1),projectNameEdit.addEventListener("blur",c,!1)}));const c=t=>{if("blur"===t.type||"Enter"===t.key){if(originalProjName===t.target.value)projectNameEdit.classList.toggle("projectNameEdit");else if(JSON.parse(localStorage.getItem("projectList")).filter((e=>e.projectName===t.target.value)).length>0){const e=document.createElement("div");return e.classList.add("editProjectValidation"),e.classList.add("validation"),e.textContent="Duplicate project name not allowed. Reverting back.",a.appendChild(e),projectNameEdit.setAttribute("readonly",!0),projectNameEdit.classList.toggle("projectNameEdit"),void(projectNameEdit.value=originalProjName)}projectNameEdit.setAttribute("readonly",!0),document.activeElement.blur(),taskListEdit=taskList,taskListEdit.forEach((e=>{e.projectName===originalProjName&&(e.projectName=t.target.value)})),projectList.forEach((e=>{e.lastSelected=!1})),e.projectName=t.target.value,e.lastSelected=!0,u(),p(),document.querySelector(".lastSelected").click()}}})),(()=>{const e=document.querySelectorAll(".tile"),t=document.querySelector("#addList"),a=document.querySelector(".title");e.forEach((s=>s.addEventListener("click",(s=>{if(!JSON.stringify(s.target.classList).includes("projDelIcon")){for(i of e)i.classList.remove("selected");s.target.closest(".tile").classList.add("selected"),isHomeTile=JSON.stringify(s.target.closest(".tile").classList).includes("homeTiles"),isHomeTile?(t.classList.add("hidden"),currentTile=s.target.closest(".tile").querySelector("div").textContent,a.innerHTML=currentTile):(t.classList.remove("hidden"),currentTile=s.target.closest(".tile").querySelector("input").value,a.innerHTML=currentTile),null!==document.querySelector(".editProjectValidation")&&document.querySelector(".editProjectValidation").remove(),o(),k()}}))))})()};var L,S;function h(e,t,a,i="No Due Date"){this.taskName=e,this.projectName=t,this.details=a,this.dueDate=i,this.completed=!1,this.important=!1}function v(e,t){let a=new Date(e);return a.setDate(e.getDate()+t),a}function y(e){let t=e.getDate();t<10&&(t="0"+t);let a=e.getMonth()+1;return a<10&&(a="0"+a),`${e.getFullYear()}-${a}-${t}`}window.addEventListener("load",(()=>{taskList=JSON.parse(localStorage.getItem("taskList"))||[],document.querySelector("#taskForm").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("listInput").value;let a=document.querySelector(".selected input");a=null===a?editProjNameCurrrent:a.value;const i=document.querySelector(".taskValidation");if(t===editTitleCurrrent);else if(JSON.parse(localStorage.getItem("taskList")).filter((e=>e.taskName+e.projectName===t+a)).length>0)return void i.classList.remove("hidden");if(!editMode){let e=document.getElementById("listInputDetail").value;""===e&&(e="No details");let i=document.getElementById("listInputDate").value;""===i&&(i="No Due Date");const s=new h(t,a,e,i);taskList.push(s)}u(),e.target.reset(),o(),k()})),currentTile="All Tasks",k()})),L=document.getElementById("listInput"),S=document.querySelector(".listSubmitBtn"),L.addEventListener("input",(e=>{""!==e.target.value?(S.disabled=!1,S.classList.remove("disabled")):(S.classList.add("disabled"),S.disabled=!0)}));const k=()=>{taskList=JSON.parse(localStorage.getItem("taskList"))||[],taskListTemp=taskList,document.querySelector(".list-todo").insertBefore(document.querySelector("#taskForm"),document.querySelector("#addList"));let e=new Date;if("Important"===currentTile)taskListTemp=taskList.filter((e=>e.important));else if("All Tasks"===currentTile)taskListTemp;else if("Today"===currentTile)taskListTemp=taskList.filter((t=>y(e)===t.dueDate));else if("Next 7 Days"===currentTile){const t=y(v(e,1)),a=y(v(e,7)),i=Date.parse(t),s=Date.parse(a);taskListTemp=taskList.filter((e=>Date.parse(e.dueDate)<=s&&Date.parse(e.dueDate)>=i))}else taskListTemp=taskList.filter((e=>e.projectName===currentTile));document.querySelector("#taskCompleteList > ul").innerHTML="",taskListTemp.forEach((e=>{const t=document.createElement("li"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div"),n=m("star_outline"),p=m("star"),L=m("edit"),S=m("delete");a.classList.add("unchecked"),i.classList.add("list-details"),s.classList.add("taskTitle"),d.classList.add("taskDetails"),l.classList.add("date"),r.classList.add("list-right"),c.classList.add("list-right-icons"),o.classList.add("starContainer"),n.classList.add("star-outline"),p.classList.add("important"),e.important?n.classList.add("listHidden"):p.classList.add("listHidden"),e.completed&&(a.classList.toggle("checked"),i.classList.toggle("lineThrough"),i.classList.toggle("fade")),S.classList.add("delIcon"),isHomeTile?s.textContent=e.projectName+" > "+e.taskName:s.textContent=e.taskName,d.textContent=e.details,l.textContent=e.dueDate,document.querySelector("ul").appendChild(t),t.appendChild(a),t.appendChild(i),i.appendChild(s),i.appendChild(d),t.appendChild(r),r.appendChild(l),r.appendChild(c),c.appendChild(o),o.appendChild(n),o.appendChild(p),c.appendChild(L),c.appendChild(S),S.addEventListener("click",(()=>{taskList=taskList.filter((t=>t.taskName+t.projectName!==e.taskName+e.projectName)),u(),k()})),a.addEventListener("click",(()=>{!0===e.completed?e.completed=!1:e.completed=!0,u(),k()})),o.addEventListener("click",(()=>{!0===e.important?e.important=!1:e.important=!0,u(),k()})),L.addEventListener("click",(()=>{editMode=!0;const a=document.createElement("div");a.classList.add("containerEdit"),t.querySelector(".unchecked").classList.add("hidden"),t.querySelector(".list-details").classList.add("hidden"),t.querySelector(".list-right").classList.add("hidden"),t.insertBefore(a,t.querySelector(".unchecked")),a.appendChild(document.getElementById("taskForm")),document.getElementById("taskForm").classList.remove("hidden");let i=document.querySelector("#listInput"),s=document.querySelector("#listInputDetail"),d=document.querySelector("#listInputDate");i.value=e.taskName,s.value=e.details,d.value=e.dueDate,document.querySelector("#editConfirm").classList.remove("hidden"),document.querySelector(".listSubmitBtn").classList.add("hidden");const l=document.querySelector("#taskForm > .inputField");for(const t of l.children)t.addEventListener("change",(()=>{e.taskName=i.value,e.details=s.value,e.dueDate=d.value||"No Due Date"}));editTitleCurrrent=e.taskName,editProjNameCurrrent=e.projectName}))})),editMode=!1,editTitleCurrrent=""}})();