(()=>{const e=document.querySelector("#addProject"),t=document.querySelector("#projectForm"),s=document.querySelector("#projectInput");e.addEventListener("click",(()=>{t.classList.remove("hidden"),s.focus()}));const a=document.querySelector("#addList"),d=document.querySelector("#taskForm"),l=document.querySelector(".listSubmitBtn"),r=document.querySelector("#editConfirm");a.addEventListener("click",(()=>{d.classList.remove("hidden"),l.classList.remove("hidden"),r.classList.add("hidden")})),document.querySelector("#checkbox").addEventListener("change",(()=>document.body.classList.toggle("light"))),document.querySelector(".hiddenMenu").addEventListener("click",(()=>{document.querySelector(".leftPanel").classList.toggle("hidden")}));const c=()=>{const e=document.querySelector("#projectForm"),t=document.querySelector("#projectInput"),s=document.querySelector(".projectValidation");t.value="",e.classList.add("hidden"),s.classList.add("hidden")},o=()=>{const e=document.querySelector("#taskForm"),t=document.querySelector("#listInput"),s=document.querySelector("#listInputDetail"),a=document.querySelector("#listInputDate"),i=document.querySelector(".taskValidation");t.value="",s.value="",a.value="",e.classList.add("hidden"),i.classList.add("hidden"),document.querySelector(".list-todo").appendChild(e),k()};function n(e){this.projectName=e,this.lastSelected=!0}document.querySelector(".projectCancelBtn").addEventListener("click",c),document.querySelector(".listCancelBtn").addEventListener("click",o),window.addEventListener("load",(()=>{projectList=JSON.parse(localStorage.getItem("projectList"))||[],document.querySelector("#projectForm").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("projectInput").value,s=document.querySelector(".projectValidation");if(projectList.filter((e=>e.projectName===t)).length>0)return void s.classList.remove("hidden");const a=new n(t);projectList.push(a),u(),e.target.reset(),c(),p(),document.querySelector("#projectCompleteList").lastChild.querySelector(".tile").click()})),isHomeTile=!0,p()}));const u=()=>{localStorage.setItem("projectList",JSON.stringify(projectList)),localStorage.setItem("taskList",JSON.stringify(taskList))},m=e=>{const t=document.createElement("span");return t.classList.add("material-icons-round"),t.textContent=e,t},p=()=>{document.querySelector("#projectCompleteList").innerHTML="",projectList.forEach((e=>{const t=document.querySelector("#projectCompleteList"),s=document.createElement("div"),a=document.createElement("div"),i=m("menu"),d=document.createElement("input");d.setAttribute("readonly",""),d.setAttribute("spellcheck",!1),d.setAttribute("maxlength",12);const l=m("edit"),r=m("delete");a.classList.add("tile"),e.lastSelected&&a.classList.add("lastSelected"),d.classList.add("projectName"),r.classList.add("projDelIcon"),d.value=e.projectName,a.appendChild(i),a.appendChild(d),a.appendChild(l),a.appendChild(r),s.appendChild(a),t.appendChild(s),r.addEventListener("click",(()=>{projectList=projectList.filter((t=>t.projectName!==e.projectName)),taskList=taskList.filter((t=>t.projectName!==e.projectName)),u(),p(),document.getElementById("allTasks").click()})),l.addEventListener("click",(()=>{projectNameEdit=a.querySelector(".projectName"),projectNameEdit.classList.toggle("projectNameEdit"),originalProjName=projectNameEdit.value,projectNameEdit.removeAttribute("readonly"),projectNameEdit.focus(),projectNameEdit.addEventListener("keypress",c,!1),projectNameEdit.addEventListener("blur",c,!1)}));const c=t=>{if("blur"===t.type||"Enter"===t.key){if(originalProjName===t.target.value)projectNameEdit.classList.toggle("projectNameEdit");else if(JSON.parse(localStorage.getItem("projectList")).filter((e=>e.projectName===t.target.value)).length>0){const e=document.createElement("div");return e.classList.add("editProjectValidation"),e.classList.add("validation"),e.textContent="Duplicate project name not allowed. Reverting back.",s.appendChild(e),projectNameEdit.setAttribute("readonly",!0),projectNameEdit.classList.toggle("projectNameEdit"),void(projectNameEdit.value=originalProjName)}projectNameEdit.setAttribute("readonly",!0),document.activeElement.blur(),taskListEdit=taskList,taskListEdit.forEach((e=>{e.projectName===originalProjName&&(e.projectName=t.target.value)})),projectList.forEach((e=>{e.lastSelected=!1})),e.projectName=t.target.value,e.lastSelected=!0,u(),p(),document.querySelector(".lastSelected").click()}}})),(()=>{const e=document.querySelectorAll(".tile"),t=document.querySelector("#addList"),s=document.querySelector(".title");e.forEach((a=>a.addEventListener("click",(a=>{if(!JSON.stringify(a.target.classList).includes("projDelIcon")){for(i of e)i.classList.remove("selected");a.target.closest(".tile").classList.add("selected"),isHomeTile=JSON.stringify(a.target.closest(".tile").classList).includes("homeTiles"),isHomeTile?(t.classList.add("hidden"),currentTile=a.target.closest(".tile").querySelector("div").textContent,s.innerHTML=currentTile):(t.classList.remove("hidden"),currentTile=a.target.closest(".tile").querySelector("input").value,s.innerHTML=currentTile),null!==document.querySelector(".editProjectValidation")&&document.querySelector(".editProjectValidation").remove(),o(),k()}}))))})()};var L,h;function S(e,t,s,a="No Due Date"){this.taskName=e,this.projectName=t,this.details=s,this.dueDate=a,this.completed=!1,this.important=!1}function v(e,t){let s=new Date(e);return s.setDate(e.getDate()+t),s}function y(e){let t=e.getDate();t<10&&(t="0"+t);let s=e.getMonth()+1;return s<10&&(s="0"+s),`${e.getFullYear()}-${s}-${t}`}window.addEventListener("load",(()=>{taskList=JSON.parse(localStorage.getItem("taskList"))||[],document.querySelector("#taskForm").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("listInput").value;let s=document.querySelector(".selected input");s=null===s?editProjNameCurrrent:s.value;const a=document.querySelector(".taskValidation");if(t===editTitleCurrrent);else if(JSON.parse(localStorage.getItem("taskList")).filter((e=>e.taskName+e.projectName===t+s)).length>0)return void a.classList.remove("hidden");if(!editMode){let e=document.getElementById("listInputDetail").value;""===e&&(e="No details");let a=document.getElementById("listInputDate").value;""===a&&(a="No Due Date");const i=new S(t,s,e,a);taskList.push(i)}u(),e.target.reset(),o(),k()})),currentTile="All Tasks",k()})),L=document.getElementById("listInput"),h=document.querySelector(".listSubmitBtn"),L.addEventListener("input",(e=>{""!==e.target.value?(h.disabled=!1,h.classList.remove("disabled")):(h.classList.add("disabled"),h.disabled=!0)}));const k=()=>{taskList=JSON.parse(localStorage.getItem("taskList"))||[],taskListTemp=taskList,0===taskList.length&&isHomeTile?document.querySelector(".noTask").classList.remove("hidden"):document.querySelector(".noTask").classList.add("hidden"),document.querySelector(".list-todo").insertBefore(document.querySelector("#taskForm"),document.querySelector("#addList"));let e=new Date;if("Important"===currentTile)taskListTemp=taskList.filter((e=>e.important));else if("All Tasks"===currentTile)taskListTemp;else if("Today"===currentTile)taskListTemp=taskList.filter((t=>y(e)===t.dueDate));else if("Next 7 Days"===currentTile){const t=y(v(e,1)),s=y(v(e,7)),a=Date.parse(t),i=Date.parse(s);taskListTemp=taskList.filter((e=>Date.parse(e.dueDate)<=i&&Date.parse(e.dueDate)>=a))}else taskListTemp=taskList.filter((e=>e.projectName===currentTile));document.querySelector("#taskCompleteList > ul").innerHTML="",taskListTemp.forEach((e=>{const t=document.createElement("li"),s=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div"),n=m("star_outline"),p=m("star"),L=m("edit"),h=m("delete");s.classList.add("unchecked"),a.classList.add("list-details"),i.classList.add("taskTitle"),d.classList.add("taskDetails"),l.classList.add("date"),r.classList.add("list-right"),c.classList.add("list-right-icons"),o.classList.add("starContainer"),n.classList.add("star-outline"),p.classList.add("important"),e.important?n.classList.add("listHidden"):p.classList.add("listHidden"),e.completed&&(s.classList.toggle("checked"),a.classList.toggle("lineThrough"),a.classList.toggle("fade")),h.classList.add("delIcon"),isHomeTile?i.textContent=e.projectName+" > "+e.taskName:i.textContent=e.taskName,d.textContent=e.details,l.textContent=e.dueDate,document.querySelector("ul").appendChild(t),t.appendChild(s),t.appendChild(a),a.appendChild(i),a.appendChild(d),t.appendChild(r),r.appendChild(l),r.appendChild(c),c.appendChild(o),o.appendChild(n),o.appendChild(p),c.appendChild(L),c.appendChild(h),h.addEventListener("click",(()=>{taskList=taskList.filter((t=>t.taskName+t.projectName!==e.taskName+e.projectName)),u(),k()})),s.addEventListener("click",(()=>{!0===e.completed?e.completed=!1:e.completed=!0,u(),k()})),o.addEventListener("click",(()=>{!0===e.important?e.important=!1:e.important=!0,u(),k()})),L.addEventListener("click",(()=>{editMode=!0;const s=document.createElement("div");s.classList.add("containerEdit"),t.querySelector(".unchecked").classList.add("hidden"),t.querySelector(".list-details").classList.add("hidden"),t.querySelector(".list-right").classList.add("hidden"),t.insertBefore(s,t.querySelector(".unchecked")),s.appendChild(document.getElementById("taskForm")),document.getElementById("taskForm").classList.remove("hidden");let a=document.querySelector("#listInput"),i=document.querySelector("#listInputDetail"),d=document.querySelector("#listInputDate");a.value=e.taskName,i.value=e.details,d.value=e.dueDate,document.querySelector("#editConfirm").classList.remove("hidden"),document.querySelector(".listSubmitBtn").classList.add("hidden");const l=document.querySelector("#taskForm > .inputField");for(const t of l.children)t.addEventListener("change",(()=>{e.taskName=a.value,e.details=i.value,e.dueDate=d.value||"No Due Date"}));editTitleCurrrent=e.taskName,editProjNameCurrrent=e.projectName}))})),editMode=!1,editTitleCurrrent=""}})();